/****** Script for SelectTopNRows command from SSMS  ******/
SELECT        dt_person.person_id, MO_WORKFLOW_STEPS.WORKFLOW_ID, MO_WORKFLOW_STEPS.WORKFLOW_STEP_ID, MO_WORKFLOW_STEP_TYPES_1.DESCRIPTION AS previous_step_type, 
                         MO_WORKFLOW_STEP_TYPES.DESCRIPTION AS step_type, MO_WORKFLOW_STEPS.STEP_STATUS AS status, MO_WORKFLOW_STEPS.PROPOSED_ON, MO_WORKFLOW_STEPS.STARTED_ON, 
                         MO_WORKFLOW_STEPS.COMPLETED_ON, MO_WORKFLOW_STEPS.CANCELLED_ON, MO_WORKFLOW_STEPS.RESPONSIBLE_TEAM_ID, MO_WORKFLOW_STEPS.ASSIGNEE_ID, 
                         MO_WORKFLOW_LINKS.SOURCE_STEP_ID, MO_WORKFLOW_STEPS_1.WORKFLOW_STEP_ID AS previous_step_id
FROM            MO_WORKFLOW_STEPS INNER JOIN
                         MO_WORKFLOW_STEP_TYPES ON MO_WORKFLOW_STEPS.WORKFLOW_STEP_TYPE_ID = MO_WORKFLOW_STEP_TYPES.WORKFLOW_STEP_TYPE_ID INNER JOIN
                         _lcc_workflow_config ON MO_WORKFLOW_STEPS.WORKFLOW_STEP_TYPE_ID = _lcc_workflow_config.config_2 INNER JOIN
                             (SELECT        DM_PERSONS.PERSON_ID AS person_id, DM_SUBGROUP_SUBJECTS.SUBGROUP_ID
                               FROM            DM_SUBGROUP_SUBJECTS INNER JOIN
                                                         DM_PERSONS ON DM_PERSONS.PERSON_ID = DM_SUBGROUP_SUBJECTS.SUBJECT_COMPOUND_ID) AS dt_person ON MO_WORKFLOW_STEPS.SUBGROUP_ID = dt_person.SUBGROUP_ID INNER JOIN
                         MO_WORKFLOW_LINKS ON MO_WORKFLOW_STEPS.WORKFLOW_STEP_ID = MO_WORKFLOW_LINKS.TARGET_STEP_ID INNER JOIN
                         MO_WORKFLOW_STEPS AS MO_WORKFLOW_STEPS_1 ON MO_WORKFLOW_LINKS.SOURCE_STEP_ID = MO_WORKFLOW_STEPS_1.WORKFLOW_STEP_ID INNER JOIN
                         MO_WORKFLOW_STEP_TYPES AS MO_WORKFLOW_STEP_TYPES_1 ON MO_WORKFLOW_STEPS_1.WORKFLOW_STEP_TYPE_ID = MO_WORKFLOW_STEP_TYPES_1.WORKFLOW_STEP_TYPE_ID
WHERE        (_lcc_workflow_config.type = 'step_mapping') AND (_lcc_workflow_config.config_1 = 'assessments') AND (MO_WORKFLOW_STEPS.PROPOSED_ON > CONVERT(DATETIME, '2022-04-01 00:00:00', 102)) AND 
                         (MO_WORKFLOW_STEPS.STEP_STATUS = 'COMPLETED')
